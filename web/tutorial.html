<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>mdcore</title>
<meta name="generator" content="Bluefish 1.0.7">
<meta name="author" content="Pedro Gonnet">
<meta name="date" content="2010-12-16T18:07:44+0000">
<meta name="copyright" content="Pedro Gonnet">
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8">
<meta http-equiv="content-style-type" content="text/css">
<meta http-equiv="expires" content="0">
<meta http-equiv="refresh" content="5; URL=http://">
<style type="text/css">
	body {font-family: courier, monospace;}
</style>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-25391540-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body>
<center>
<table cellpadding="5" cellspacing="2" border="0" valign="top" width="700">
	<tr><td colspan="2"><span style="font-size: 48px; font-weight: bold;">mdcore</span></td></tr>
	<tr>
		<td width="20%" valign="top">
			<p/>
			<a href="index.html">About</a><br/>
			<a href="features.html">Features<br/>
			<a href="download.html">Download</a><br/>
			<a href="publications.html">Publications</a><br/>
			<a href="documentation.html">Documentation</a><br/>
			Tutorial<br/>
            <p><a href="http://sourceforge.net/projects/mdcore"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=354770&amp;type=10" width="80" height="15" alt="Get mdcore at SourceForge.net. Fast, secure and Free Open Source software downloads" /></a>
		</td>
		<td valign="top">
        
			<p><b>Compiling mdcore</b></p>
            <p>Download and unpack the sources. This should create a directory
            named "mdcore". Change to this directory and execute
            the configuration script as follows</p>
            <blockquote style="background-color:lightgrey;padding:4px">
                cd mdcore<br/>
                ./configure
            </blockquote>
            
            <p>The "configure" script will try to guess the best compiler options
            and the location of the required libraries. To see the available options,
            type</p>
            <blockquote style="background-color:lightgrey;padding:4px">
                ./configure --help
            </blockquote>
            <p>The most interesting options are</p>
            <ul>
                <li/><b>--enable-mpi</b>: Compile with MPI to enable basic
                    distributed-memory parallelism.
                <li/><b>--with-gcc-arch=<i>arch</i></b>: Optimize for the
                    given architecture. If compiling on the same architecture on which
                    the simulations will be run, use "--with-gcc-arch=native".
                <li/><b>--with-cell=<i>path</i></b>: Specifies the prefix where the IBM
                    Cell-SDK and toolchain are installed and enables parallelism
                    on the Cell's SPUs.
            </ul>
            
            <p>Once the configuration process has completed successfully,
            compile the library by typing</p>
            <blockquote style="background-color:lightgrey;padding:4px">
                make
            </blockquote>
            
            <p>This will generate the following libraries in the sub-folder
            "src/.libs":
            <ul>
                <li/><b>libmdcore.a</b>: The mdcore library in double precision,
                <li/><b>libmdcore_single.a</b>: The mdcore library in 
                    single precision,
                <li/><b>libmdcore_cell.a</b>: The mdcore library in 
                    for the Cell/BE (if configured with "--with-cell").
            </ul>
            
            <p style="padding-top:10px"><b>Some notes on OpenMP on Linux</b></p>
            <p>mdcore relies on both pthreads and OpenMP for parallelization,
            using the former to parallelize the force computation and the latter
            for more simple tasks such as updating the particle positions or
            computing the system temperature. Depending on your OpenMP-implementation,
            the following environment variables may be useful:</p>
            <ul>
                <li/><b>OMP_NUM_THREADS=<i>n</i></b>: Use only <i>n</i> parallel
                    threads for the OpenMP-parallel regions. This has no effect
                    on the number of threads specified when initializing
                    mdcore with "engine_start( &amp;e , nr_runners )".
                    If you are running on a CPU or CPUs with Hyper-Threading,
                    it can be useful to specify the number of physical cores
                    as opposed to the number of virtual threads.
                <li><b>OMP_WAIT_POLICY=PASSIVE</b>: On some Linux systems,
                    the default behavior for inactive OpenMP threads is to
                    cycle idly without relinquishing the CPU. This can obstruct
                    other threads created with pthreads, which is why this
                    variable should be set to PASSIVE.
            </ul>
            <p>For convenience, these variables can be set on the command
            line:</p>
            <blockquote style="background-color:lightgrey;padding:4px">
                OMP_WAIT_POLICY=PASSIVE OMP_NUM_THREADS=8 ./simulation ...
            </blockquote>
            
            <p style="padding-top:10px"><b>Example programs</b></p>
            <p>The directory "mdcore/examples" contains a number of small
            simulations which offer a useful starting point for experimenting
            with mdcore and implementing your own simulation.</p>
            
            <ul>
                <li/><b>argon</b>: A simple simulation consisting
                    of 10x10x10 cells of bulk argon at 100 K (the number of
                    particles is adjusted depending on the cell edge length).
                    The simulation is executed with the following parameters
                    <blockquote style="background-color:lightgrey;padding:4px">
                        ./argon <i>n</i> <i>steps</i> <i>dt</i> <i>L</i>
                    </blockquote>
                    where <i>n</i> is the number of processors to use, <i>steps</i>
                    are the number of time steps of length <i>dt</i> picoseconds
                    to take and <i>L</i> is the cell edge length to use.
                    
                    <p>Two other executables, "argon_verlet" and "argon_pwverlet" are
                    provided, which use Verlet and pairwise Verlet lists
                    respectively. The "skin" width used in the lists is the 
                    supplied edge length <i>L</i> minus a fixed cutoff of
                    1.0 nm.
                    
                    <p>Velocity scaling with a coupling constant of 0.1 is used
                    during the first 10000 steps to maintain a temperature
                    of 100 K.
                    
                <li/><b>bulk</b>: A bulk water simulation consisting of
                    8x8x8 cells of rigid SPC/E water molecules at 300 K
                    (the number of molecules is adjusted depending on the cell
                    edge length). The water molecules are kept rigid using
                    the SHAKE algorithm to half the digits of machine precision.
                    The simulation is executed with the same
                    set of parameters as "argon" above.
                    
                    <p>The executable "test" is linked with the double-precision
                    version of mdcore whereas "test_single" is linked with 
                    the single-precision version.
                    
                    <p>If mdcore was configures with the "--with-cell" option,
                    then "test_cell" executes the simulation using as many SPUs
                    as are available.
                    
                <li/><b>hybrid</b>: Similar to the "bulk" simulation above,
                    yet with 16x16x16 cells of edge length 1.0 nm.
                    The "hybrid" simulation requires
                    mdcore to have been compiled with the "--enable-mpi"
                    option and is executed as follows:
                    <blockquote style="background-color:lightgrey;padding:4px">
                        mpirun -x OMP_WAIT_POLICY -x OMP_NUM_THREADS -np <i>m</i> ./hybrid <i>n</i> <i>steps</i>
                    </blockquote>
                    where <i>m</i> is the number of MPI nodes to use and
                    <i>n</i> is the number of threads to use on each node.
                    
                    Since bisection is used to split the domain, it is
                    recommended, for proper load balancing,
                    that <i>m</i> be a power of 2.
                    
            </ul>
            
		</td>
	</tr>
</table>
</center>

<!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://sourceforge.net/apps/piwik/mdcore/" : "http://sourceforge.net/apps/piwik/mdcore/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://sourceforge.net/apps/piwik/mdcore/piwik.php?idsite=1" style="border:0" alt=""/></p></noscript>
<!-- End Piwik Tag -->

</body>
</html>
